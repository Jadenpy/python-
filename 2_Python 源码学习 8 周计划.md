# 《Python 源码学习 8 周计划》

结合你 “通过阅读源码学风格、学解决问题思路” 的核心目标，以及推荐的库 / 项目，我为你制定了 **“从易到难、从点到面” 的 8 周学习计划**，同时明确每阶段的准备条件和学习重点，确保节奏可控、目标清晰。

# 一、学习总目标



1.  掌握 “Pythonic 代码风格”：理解优秀项目的命名规范、类设计、逻辑分层；

2.  提炼 “解决问题的结构化思路”：从源码中总结 “复杂需求拆解”“组件协作”“扩展性设计” 的通用方法；

3.  形成 “由小及大的 OOP 思维”：能独立分析 “原子类→中层组件→顶层系统” 的嵌套逻辑。

# 二、前置准备条件（开始前 1-2 天完成）

在正式学习前，先做好以下准备，避免中途卡壳：



| 准备项          | 具体操作                                                                                                                                                                                                                                                                          | 目的                                      |
| ------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------- |
| 1. 源码阅读环境搭建  | - 安装 Python 3.9+（推荐 3.10，与多数库的源码兼容性好）；- 用 PyCharm/VS Code 打开源码（支持 “跳转定义”“查找引用”，方便追源码链路）；- 安装`git`（用于克隆三方库源码，避免直接下载压缩包丢失提交记录）。                                                                                                                                                 | 高效追源码、看函数 / 类的关联关系，避免手动翻文件浪费时间。         |
| 2. 源码获取方式    | - 内置库：直接在 Python 安装目录的`Lib`文件夹下找到（如`Lib/datetime.py`）；- 三方库：用`git clone`克隆 GitHub 仓库（如`git clone https://github.com/psf/requests.git`，`git clone https://github.com/pydantic/pydantic.git`）；- 项目（FastAPI/Django）：同上，克隆后重点看`fastapi/`或`django/db/models/`目录。                   | 获取完整源码（含注释、测试用例），比看在线文档更全面。             |
| 3. 辅助工具 / 文档 | - 安装`pydoc`（Python 自带，用`pydoc datetime`查看内置库官方文档）；- 收藏库的官方文档（如 requests 文档：[https://requests.readthedocs.io/](https://requests.readthedocs.io/)，FastAPI 文档：[https://fastapi.tiangolo.com/](https://fastapi.tiangolo.com/)）；- 准备一个 “源码笔记” 文档（Markdown 格式，记录每阶段的 “风格总结”“思路提炼”）。 | 随时查官方说明，避免误解源码逻辑；记录笔记方便复盘。              |
| 4. 基础认知回顾    | - 回顾 Python OOP 核心概念（类继承、多态、组合 / 聚合、元类基础）；- 简单用一遍推荐的库（如用`requests.get()`发请求、用`pydantic.BaseModel`定义一个数据模型）。                                                                                                                                                                   | 先 “会用” 再 “看源码”，明确 “要解决的问题是什么”，避免看源码时迷茫。 |

# 三、8 周学习计划（每周 5-6 小时，每天 1 小时左右）

## 第 1-2 周：入门热身 —— 吃透 2 个内置库（聚焦 “风格基础”）

**核心目标**：理解 “简洁、职责单一” 的代码风格，掌握 “基础功能的 OOP 封装” 思路。



| 时间    | 学习内容          | 具体任务                                                                                                                                                                                                                                                                                               | 输出成果（笔记重点）                                                                                                                        |
| ----- | ------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------- |
| 第 1 周 | 内置库`datetime` | 1. 第一天：看`date`类（`__init__`、`today()`、`strftime()`方法）；2. 第二天：看`time`类（`__init__`、`utcoffset()`方法，了解时区基础）；3. 第三天：看`datetime`类（如何组合`date`和`time`，`__add__`方法如何与`timedelta`交互）；4. 第四天：看`timedelta`类（`__init__`、`total_seconds()`方法，理解时间差计算逻辑）；5. 第五天：总结`datetime`的类设计风格（职责划分、方法命名、边界处理）。               | 1. 风格：`datetime`如何通过 “小类拆分” 避免大类臃肿；2. 思路：时间计算的边界场景（闰年、跨月）如何处理；3. 疑问：记录看不懂的细节（如`tzinfo`抽象类的作用）。                                    |
| 第 2 周 | 内置库`json`     | 1. 第一天：看`dumps()`函数（调用链路：`dumps()`→`JSONEncoder.encode()`）；2. 第二天：看`JSONEncoder`类（`__init__`、`default()`、`encode()`方法，理解序列化逻辑）；3. 第三天：看`loads()`函数（调用链路：`loads()`→`JSONDecoder.decode()`）；4. 第四天：看`JSONDecoder`类（`__init__`、`decode()`、`object_hook`参数的作用）；5. 第五天：总结`json`的分层逻辑（底层细节→中层扩展→顶层 API）。 | 1. 风格：如何设计 “用户友好的顶层 API”（隐藏底层复杂度）；2. 思路：序列化 / 反序列化的 “通用规则 + 自定义扩展” 如何平衡；3. 实践：尝试重写`JSONEncoder`的`default()`方法，实现`datetime`对象的序列化。 |

## 第 3-4 周：进阶实践 —— 攻克 2 个三方库（聚焦 “工程化思路”）

**核心目标**：理解 “复杂需求的拆解”“组件协作”“元编程的合理使用”，学习工业级项目的代码风格。



| 时间    | 学习内容          | 具体任务                                                                                                                                                                                                                                                                                                                                                                       | 输出成果（笔记重点）                                                                                                                                  |
| ----- | ------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------- |
| 第 3 周 | 三方库`requests` | 1. 第一天：看`requests/api.py`（`get()`、`post()`函数，理解顶层 API 设计）；2. 第二天：看`requests/sessions.py`（`Session`类的`__init__`、`request()`方法，核心逻辑入口）；3. 第三天：看`requests/models.py`（`PreparedRequest`类：如何组装请求参数；`Response`类：如何封装响应结果）；4. 第四天：看`requests/adapters.py`（`HTTPAdapter`类：如何管理连接池，与`urllib3`的交互）；5. 第六天：总结`requests`的组件协作逻辑（`Session`→`PreparedRequest`→`HTTPAdapter`→`Response`）。 | 1. 风格：如何用 “函数封装类实例” 简化用户调用（如`get()`函数创建临时`Session`）；2. 思路：HTTP 请求的复杂流程（参数组装、连接管理、响应解析）如何拆解为多个组件；3. 实践：模仿`requests`的风格，写一个简化版的 “HTTP 请求工具类”。 |
| 第 4 周 | 三方库`pydantic` | 1. 第一天：看`pydantic/main.py`（`BaseModel`类的`__init__`方法，理解数据初始化逻辑）；2. 第二天：看`pydantic/fields.py`（`Field`类：如何定义字段规则，与`BaseModel`的关联）；3. 第三天：看`pydantic/validators.py`（内置验证器，如`int_validator`，理解类型校验逻辑）；4. 第四天：看`pydantic/_internal/_model_construction.py`（元类`ModelMetaclass`如何解析字段，生成验证逻辑）；5. 第六天：总结`pydantic`的元编程使用场景（何时该用元类简化用户代码）。                                          | 1. 风格：如何用 “元编程隐藏复杂度”，同时保持用户接口简洁；2. 思路：数据验证的 “默认规则 + 自定义扩展” 如何设计（`Field`→`validator`→`BaseModel`）；3. 疑问：记录元类相关的难点（如`__new__`方法的作用），后续逐步理解。   |

## 第 5-7 周：综合提升 —— 剖析 2 个 OOP 项目（聚焦 “嵌套逻辑”）

**核心目标**：掌握 “原子类→中层组件→顶层系统” 的嵌套设计，形成 “由小及大” 的 OOP 思维。



| 时间      | 学习内容                                     | 具体任务                                                                                                                                                                                                                                                                                                                                                                                                                                         | 输出成果（笔记重点）                                                                                                                                                                          |
| ------- | ---------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 第 5-6 周 | 项目`FastAPI`（重点看`fastapi/`目录）             | 1. 第 5 周 1-2 天：看`fastapi/routing.py`（`APIRoute`类：如何封装 “一个接口的逻辑”，依赖`Request`/`Response`）；2. 第 5 周 3-4 天：看`fastapi/routing.py`（`APIRouter`类：如何管理多个`APIRoute`，`include_router()`方法的作用）；3. 第 5 周 5-6 天：看`fastapi/applications.py`（`FastAPI`类：如何组合`APIRouter`，`__call__`方法如何处理请求）；4. 第 6 周 1-2 天：看`fastapi/dependencies/utils.py`（`Depends`类：依赖注入逻辑，如何组合多个依赖）；5. 第 6 周 3-5 天：画`FastAPI`的组件嵌套图（`Request`→`APIRoute`→`APIRouter`→`FastAPI`），总结协作逻辑。 | 1. 风格：如何设计 “可扩展的路由系统”（`APIRoute`负责单接口，`APIRouter`负责组管理）；2. 思路：依赖注入的 “解耦” 思路（如何让接口逻辑不依赖具体的依赖实现）；3. 实践：模仿`FastAPI`的风格，写一个简化版的 “路由管理器”（支持添加路由、执行路由逻辑）。                                 |
| 第 7 周   | 项目`Django ORM`（重点看`django/db/models/`目录） | 1. 第 1-2 天：看`django/db/models/fields/__init__.py`（`Field`类：`__init__`、`db_type()`方法，理解字段与数据库类型的映射）；2. 第 3-4 天：看`django/db/models/base.py`（`Model`类：如何通过元类解析`Field`，`_meta`属性的作用）；3. 第 5 天：看`django/db/models/query.py`（`QuerySet`类：`filter()`、`order_by()`方法，理解链式查询逻辑）；4. 第 6 天：总结`Django ORM`的嵌套逻辑（`Field`→`Model`→`QuerySet`→`DatabaseWrapper`）。                                                                                           | 1. 风格：如何设计 “与数据库无关的模型层”（`Model`不依赖具体数据库，通过`Field.db_type()`适配）；2. 思路：链式查询的 “不可变对象” 思路（每次`filter()`返回新`QuerySet`，保证线程安全）；3. 对比：`FastAPI`和`Django ORM`的嵌套设计差异（前者是 “请求链路”，后者是 “数据链路”）。 |

## 第 8 周：复盘总结 —— 沉淀通用方法（聚焦 “能力迁移”）

**核心目标**：将前 7 周的学习成果转化为 “可复用的风格 / 思路”，能应用到自己的代码中。



| 时间    | 学习内容       | 具体任务                                                                                                                                                                                                                                                | 输出成果（最终笔记）                                                                                                        |
| ----- | ---------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------- |
| 第 8 周 | 全阶段复盘 + 实践 | 1. 第 1-2 天：整理前 7 周的笔记，按 “风格”“思路”“OOP 嵌套” 三类汇总（如 “风格” 含命名规范、分层逻辑；“思路” 含需求拆解、扩展设计）；2. 第 3-4 天：提炼 “通用方法”（如 “复杂需求拆解 = 拆分为原子类 + 定义组件交互规则”“扩展性设计 = 预留钩子 + 接口抽象”）；3. 第 5-6 天：实践检验（选一个自己的小需求，用学到的风格 / 思路写代码，如 “写一个简易的配置解析库”，模仿`json`的分层逻辑和`pydantic`的验证思路）。 | 1. 《Python 源码学习风格手册》：含命名、类设计、逻辑分层的具体规范；2. 《解决问题的结构化思路》：含需求拆解、组件协作、扩展性设计的通用步骤；3. 实践代码：用学到的方法完成一个小项目，对比之前的代码，标注改进点。 |

# 四、关键注意事项（避免走弯路）



1.  **不追求 “逐行看懂”**：源码中难免有边角料（如兼容性处理、性能优化的细节），重点看 “核心逻辑”（如类的`__init__`、核心方法、组件交互链路），看不懂的细节先标记，后续再回头看；

2.  **“用”“看”“练” 结合**：每学一个库 / 组件，先自己用代码实现类似功能（哪怕简化版），再对比源码找差异（如 “我写的 HTTP 工具类和`requests`的差距在哪”），避免只看不动手；

3.  **控制节奏，不赶进度**：如果某周的内容太难（如`pydantic`的元类），可延长 1-2 天，重点是 “理解思路” 而非 “完成时间”；

4.  **定期复盘**：每周日花 30 分钟回顾本周内容，用 “自己的话” 总结核心收获，避免学完就忘。

通过这个计划，你能逐步从 “看懂源码” 过渡到 “借鉴源码”，最终形成自己的代码风格和解决问题的思路，比单纯刷教程更有针对性。如果某阶段遇到卡点（如追源码链路时迷路），可以随时针对具体模块提问，我们一起拆解～

> （注：文档部分内容可能由 AI 生成）